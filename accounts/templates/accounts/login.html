{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Khplwak Property Dealer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <style>
    body.login-page-bg{min-height:100vh;background:radial-gradient(circle at 20% 20%,#1f2937 0%,#0f172a 70%);display:flex;align-items:center;justify-content:center;color:#fff}
    .login-card{max-width:400px;width:100%;background:rgba(30,41,59,.6);backdrop-filter:blur(16px);border-radius:16px;border:1px solid rgba(255,255,255,.07);box-shadow:0 30px 80px rgba(0,0,0,.8);color:#fff}
    .login-header{text-align:center;padding-top:1.25rem;border-bottom:none}
    .brand-chip{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#0ea5e9 0%,#14b8a6 60%);color:#0f172a;font-weight:600;font-size:.9rem;display:flex;align-items:center;justify-content:center;margin:0 auto .75rem;box-shadow:0 12px 30px rgba(14,165,233,.45)}
    .login-title{font-size:1rem;font-weight:600;color:#fff}
    .login-sub{font-size:.8rem;color:#94a3b8}
    .login-body{padding:1.25rem 1.25rem 1rem}
    label.form-label{color:#cbd5e1;font-size:.8rem;font-weight:500}
    .form-control.bg-darkish{background:rgba(15,23,42,.6);border:1px solid rgba(148,163,184,.3);color:#fff;border-radius:10px}
    .form-control.bg-darkish:focus{background:rgba(15,23,42,.8);border-color:#38bdf8;box-shadow:0 0 10px rgba(56,189,248,.4);color:#fff}
    .btn-login{border:none;border-radius:10px;background:linear-gradient(135deg,#0ea5e9 0%,#14b8a6 60%);color:#0f172a;font-weight:600;font-size:.9rem;padding:.8rem 1rem;width:100%;box-shadow:0 20px 40px rgba(14,165,233,.4)}
    .btn-login:hover{box-shadow:0 28px 60px rgba(14,165,233,.55);transform:translateY(-1px) scale(1.01)}
    .login-footer-line{font-size:.7rem;text-align:center;color:#475569;padding-bottom:1rem}
    .alert-login{font-size:.8rem;border-radius:8px;padding:.75rem .9rem;background:rgba(239,68,68,.12);color:#fecaca;border:1px solid rgba(239,68,68,.4)}
    .field-error{font-size:.75rem;color:#fecaca;margin-top:.25rem}
  </style>
</head>
<body class="login-page-bg">

  <div class="login-card card shadow-lg border-0">
    <div class="login-header card-header bg-transparent">
      <div class="brand-chip">KP</div>
      <h1 class="login-title">Khplwak Property Dealer</h1>
      <p class="login-sub">Admin Dashboard Access</p>
    </div>

    <div class="login-body card-body">
      {% if form.non_field_errors %}
        <div class="alert-login mb-3">
          {% for e in form.non_field_errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
        </div>
      {% endif %}

      <form method="post" novalidate>
        {% csrf_token %}

        {# ✅ Safe “next” handling with LoginView #}
        {% if redirect_field_value %}
          <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}">
        {% endif %}

        <div class="mb-3">
          <label for="id_username" class="form-label">Username</label>
          <input type="text" name="username" id="id_username"
                 class="form-control bg-darkish {% if form.username.errors %}is-invalid{% endif %}"
                 value="{{ form.data.username|default:'' }}" required autofocus autocomplete="username"
                 placeholder="Enter your username">
          {% if form.username.errors %}
            <div class="field-error">
              {% for e in form.username.errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="mb-3">
          <label for="id_password" class="form-label">Password</label>
          <input type="password" name="password" id="id_password"
                 class="form-control bg-darkish {% if form.password.errors %}is-invalid{% endif %}"
                 required autocomplete="current-password" placeholder="••••••••">
          {% if form.password.errors %}
            <div class="field-error">
              {% for e in form.password.errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>

        <button type="submit" class="btn-login">Sign in</button>
        <p class="text-center mt-3" style="font-size:.75rem;color:#94a3b8">Authorized access only.</p>
      </form>
    </div>

    <div class="login-footer-line">© 2025 Khplwak Property Dealer. All rights reserved.</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
