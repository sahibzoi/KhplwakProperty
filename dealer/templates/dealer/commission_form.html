{% extends 'dealer/base.html' %}
{% block content %}
{% load currency_filters %}

<style>
    body {
        background: radial-gradient(circle at 20% 20%, #f0fdf4 0%, #ffffff 60%);
    }

    .card {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .card-header {
        border: none;
        background: linear-gradient(90deg, #065f46 0%, #0f766e 100%);
        color: white;
        border-radius: 1rem 1rem 0 0 !important;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .card-header i {
        font-size: 1.3rem;
        opacity: 0.9;
        color: #facc15;
    }

    .card-header h5 {
        font-weight: 600;
        margin: 0;
    }

    .section-subtitle {
        font-size: 0.9rem;
        opacity: 0.85;
        margin-top: 0.2rem;
        color: #fefce8;
    }

    .form-label {
        font-weight: 600;
        color: #064e3b;
    }

    .form-control,
    .form-select,
    textarea.form-control {
        border-radius: 0.5rem;
        padding: 0.6rem 0.8rem;
    }

    .form-control:focus,
    .form-select:focus,
    textarea.form-control:focus {
        border-color: #0d9488;
        box-shadow: 0 0 0 0.2rem rgba(13,148,136,.25);
    }

    .btn-primary {
        background: linear-gradient(90deg, #065f46 0%, #0f766e 100%);
        border: none;
        border-radius: 0.5rem;
        padding: 0.6rem 1.2rem;
        font-weight: 600;
        color: #fff;
    }
    .btn-primary:hover {
        background: linear-gradient(90deg, #0f766e 0%, #065f46 100%);
    }

    .btn-outline-secondary {
        border-radius: 0.5rem;
        padding: 0.6rem 1.2rem;
        font-weight: 500;
        color: #065f46;
        border-color: #065f46;
    }
    .btn-outline-secondary:hover {
        background-color: #065f46;
        color: #fff;
    }

    .text-gold {
        color: #facc15;
    }

    .form-text {
        font-size: .8rem;
        color: #6b7280;
    }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold text-success d-flex align-items-center">
        <i class="bi bi-cash-coin me-2 text-gold"></i>
        {% if form.instance.id %}
            Edit Commission
        {% else %}
            Add Commission
        {% endif %}
    </h3>

    <a href="{% url 'commission_list' %}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-arrow-left"></i> Back to Commissions
    </a>
</div>

<form method="post">
    {% csrf_token %}

    <div class="card mb-4">
        <div class="card-header">
            <i class="bi bi-clipboard-check"></i>
            <div>
                <h5>Deal & Commission Info</h5>
                <p class="section-subtitle mb-0">Record your earning from a closed deal</p>
            </div>
        </div>

        <div class="card-body">
            <div class="row">

                <!-- Property -->
                <div class="col-md-4 mb-3">
                    <label class="form-label">Property</label>
                    {{ form.property_item }}
                    <div class="form-text">Which property this deal was for</div>
                </div>

                <!-- Deal type -->
                <div class="col-md-4 mb-3">
                    <label class="form-label">Deal Type</label>
                    {{ form.deal_type }}
                    <div class="form-text">Sale / Rent / Mortgage</div>
                </div>

                <!-- Total deal amount -->
                <div class="col-md-4 mb-3">
                    <label class="form-label">Deal Amount (AFN)</label>
                    {{ form.deal_amount }}
                    <div class="form-text">Full sale price OR rent advance OR mortgage deposit</div>
                </div>

                <!-- Commission type -->
                <div class="col-md-4 mb-3">
                    <label class="form-label">Commission Type</label>
                    {{ form.commission_type }}
                    <div class="form-text">Percentage or fixed fee?</div>
                </div>

                <!-- Commission value -->
                <div class="col-md-4 mb-3">
                    <label class="form-label">Commission Value</label>
                    {{ form.commission_value }}
                    <div class="form-text">
                        If percentage: enter like 1.5<br>
                        If fixed: enter amount like 10000
                    </div>
                </div>

                <!-- Notes -->
                <div class="col-md-12 mb-3">
                    <label class="form-label">Notes / Client / Remarks</label>
                    {{ form.notes }}
                    <div class="form-text">Example: "paid by landlord", "split with Ahmad", etc.</div>
                </div>

            </div>
        </div>
    </div>

    <div class="d-flex justify-content-end mb-5">
        <a href="{% url 'commission_list' %}" class="btn btn-outline-secondary me-2">
            <i class="bi bi-x-circle"></i> Cancel
        </a>
        <button type="submit" class="btn btn-primary">
            <i class="bi bi-save"></i> Save Commission
        </button>
    </div>
</form>

{% endblock %}
